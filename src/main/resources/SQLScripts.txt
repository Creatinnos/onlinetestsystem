drop database ONLINETESTSYSTEM;
create database ONLINETESTSYSTEM;

use ONLINETESTSYSTEM;

create table ORGANIZATION(ORGANIZATIONID bigint primary key auto_increment,EMAIL varchar(255),ORGANIZATIONNAME varchar(255),PHONENUMBER varchar(255),CREATEDDATE varchar(255),LASTMODIFIEDDATE varchar(255));
create table USERINFO(USERID bigint primary key auto_increment,USERNAME varchar(255) BINARY,PASSWORD varchar(255) BINARY ,EMAIL varchar(255),ORGANIZATIONID BIGINT,PHONENUMBER varchar(255),CREATEDDATE varchar(255),LASTMODIFIEDDATE varchar(255),ISADMIN INT);
create table QUESTION(QUESTIONID bigint primary key auto_increment,QUESTION varchar(255),CHOICETYPE varchar(255),UPLOADDATE varchar(255),QUESTIONCATEGORY VARCHAR(255),POINTS INT,ISNEGATIVEAPPLICABLE VARCHAR(64));
CREATE TABLE QUESTIONANSWEREXPLANATION(QUESTIONANSWEREXPLANATIONID bigint primary key auto_increment,QUESTIONID BIGINT,EXPLANATION VARCHAR(2048));
create table CHOICES(CHOICEID bigint primary key auto_increment,QUESTIONID bigint,CHOICE varchar(255),ISANSWER varchar(255));
create table EXAM(EXAMID bigint primary key auto_increment,EXAMNAME VARCHAR(255), ORGANIZATIONID BIGINT,QUESTIONID BIGINT,EXAMSTARTDATE datetime,EXAMENDDATE datetime,EXAMDURATION VARCHAR(255),PROGRESS int);
create table EVENTSINFO(EVENTSINFOID bigint primary key auto_increment,EVENTSINFO VARCHAR(255), USERID BIGINT,USERNAME VARCHAR(255),CREATEDDATE varchar(255),LASTMODIFIEDDATE varchar(255));

create table CANDIDATE(CANDIDATEID bigint primary key auto_increment,USERNAME varchar(255),PASSWORD varchar(255) BINARY, EMAIL varchar(255),PHONENUMBER varchar(255),CREATEDDATE varchar(255),LASTMODIFIEDDATE varchar(255));
create table EXAMMAPPING(EXAMMAPPINGID bigint primary key auto_increment,EXAMID BIGINT,CANDIDATEID BIGINT,EXAMVALIDITYDAY INT,EXAMVALIDITYMONTH INT,EXAMVALIDITYYEAR INT);
CREATE TABLE EXAMSCORE(EXAMSCOREID bigint primary key auto_increment,CANDIDATEID VARCHAR(255),EXAMID BIGINT,QUESTIONID BIGINT,SELECTEDCHOICE BIGINT,ISCORRECTANSWER VARCHAR(255),POINTS VARCHAR(255));

#EXISITING USER VALIDATION QUERY
SELECT 1 FROM ORGANIZATION WHERE USERNAME='' AND PASSWORD='';
#REGISTERING NEW USER
INSERT INTO ORGANIZATION(USERNAME,PASSWORD,EMAIL ,ORGANIZATIONNAME ,PHONENUMBER ,CREATEDDATE ,LASTMODIFIEDDATE) VALUES(?,?,?,?,?,?,?);
#FETCHING ORGANIZATION INFORMATION FOR USER HOME PAGE
SELECT * FROM EXAM WHERE EXAMSCHEDULEMONTH > (EXAMSCHEDULEMONTH-12) AND EXAMSCHEDULEYEAR> (EXAMSCHEDULEYEAR-1); 
#INSERTING EXAM DETAIL
INSERT INTO QUESTION(QUESTION,CHOICETYPE,UPLOADDATE,QUESTIONCATEGORY,POINTS,ISNEGATIVEAPPLICABLE)VALUES(?,?,?,?,?,?);
INSERT INTO CHOICES(QUESTIONID,CHOICE,ISANSWER) VALUE(?,?,?,?);
INSERT INTO EXAM(EXAMNAME,ORGANIZATIONID,QUESTIONID,EXAMSTARTDATE,EXAMENDDATE,PROGRESS) VALUES (?,?,?,?,?,?);
#ENROLLING CANDIDATE
INSERT INTO CANDIDATE(USERNAME,PASSWORD,EMAIL,PHONENUMBER,CREATEDATE,LASTMODIFIED) VALUES(?,?,?,?,?,?);
#EXAM MAPPING FOR CANDIDATE
INSERT INTO EXAMMAPPING(EXAMID,CANDIDATEID,EXAMVALIDITYDAY,EXAMVALIDITYMONTH,EXAMVALIDITYYEAR) VALUES(?,?,?,?,?);
#WHILE EXAM SUBMISSION STORING EXAMATTENDEDID
SELECT ISANSWER FROM CHOICES WHERE CHOICESID=(?/*SELECTEDCHOICE*/);
SELECT POINTS FROM QUESTION WHERE QUESTIONID=(?/*QUESTIONID*/);
INSERT INTO EXAMSCORE(CANDIDATEID,EXAMID,QUESTIONID,SELECTEDCHOICE,ISCORRECTANSWER,POINTS) VALUES (?,?,?,?,?,?);
#IF ORGANIZATION IS READY TO UPLOAD THE EXPLANATION FOR THE ANSWER
INSERT INTO QUESTIONANSWEREXPLANATION(QUESTIONID,EXPLANATION) VALUES(?,?);



select * from question;
select * from choices